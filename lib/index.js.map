{"version":3,"file":"index.js","mappings":"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","sources":["webpack://ReactUseAsyncHook/webpack/universalModuleDefinition","webpack://ReactUseAsyncHook/external umd \"react\"","webpack://ReactUseAsyncHook/webpack/bootstrap","webpack://ReactUseAsyncHook/webpack/runtime/compat get default export","webpack://ReactUseAsyncHook/webpack/runtime/define property getters","webpack://ReactUseAsyncHook/webpack/runtime/hasOwnProperty shorthand","webpack://ReactUseAsyncHook/./src/index.js"],"sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"react\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([\"react\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"react-use-async-hook\"] = factory(require(\"react\"));\n\telse\n\t\troot[\"ReactUseAsyncHook\"] = factory(root[\"react\"]);\n})(self, (__WEBPACK_EXTERNAL_MODULE__156__) => {\nreturn ","module.exports = __WEBPACK_EXTERNAL_MODULE__156__;","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","/* eslint import/no-unresolved: [2, { ignore: ['^react$'] }] */\nimport {\n    useState, useEffect, useRef, useCallback,\n} from 'react';\n\nconst identity = (x) => x;\n\nconst defaultConfig = {\n    dataLoader: identity,\n    executeOnLoad: true,\n    executeOnChange: true,\n    initialData: null,\n    onError: (error) => {\n        // eslint-disable-next-line no-console\n        console.error(error);\n    },\n};\n\nconst configAliases = {\n    autoExecute: 'executeOnLoad',\n};\n\nconst mergeConfig = (config, defaults) => {\n    const result = {\n        ...config,\n    };\n\n    Object.entries(configAliases).forEach(([keyToBeAliased, alias]) => {\n        if (keyToBeAliased in result) {\n            if (alias in result) {\n                // Both alias and keyToBeAlias are given\n                delete result[keyToBeAliased];\n                return;\n            }\n            result[alias] = result[keyToBeAliased];\n            delete result[keyToBeAliased];\n        }\n    });\n\n    Object.entries(defaults).forEach(([key, value]) => {\n        if (!(key in result)) {\n            result[key] = value;\n        }\n    });\n\n    return result;\n};\n\nconst useAsync = (config) => {\n    const {\n        task, dataLoader, initialData, executeOnLoad, onError, executeOnChange,\n    } = mergeConfig(config, defaultConfig);\n\n    const [data, setData] = useState(initialData);\n    const [error, setError] = useState('');\n    const [taskResult, setTaskResult] = useState(null);\n\n    const [loading, setLoading] = useState(!!executeOnLoad);\n\n    const isUnhooked = useRef(false);\n    const shouldExecute = useRef(executeOnLoad);\n\n    const run = useCallback(async (...taskArgs) => {\n        const unhooked = isUnhooked.current;\n\n        try {\n            setLoading(true);\n            const res = await task(...taskArgs);\n            setTaskResult(res);\n            const retrievedData = await dataLoader(res);\n\n            if (!unhooked) {\n                setData(retrievedData);\n                setError('');\n            }\n        } catch (e) {\n            onError(e);\n            if (!unhooked) {\n                setError(e);\n            }\n        } finally {\n            if (!unhooked) {\n                setLoading(false);\n            }\n        }\n    }, [dataLoader, onError, task]);\n\n    useEffect(() => {\n        if (shouldExecute.current) {\n            run();\n        }\n\n        if (shouldExecute.current && !executeOnChange) {\n            // when shouldExecute.current is true and executeOnChange is false,\n            // any task change should not trigger run automatically.\n            // Since shouldExecute.current is controlling the execution\n            // of run, we set it to false.\n            //\n            // When executeOnLoad is false, shouldExecute.current is\n            // already false, and hence will not execute run on change\n            // of run, irrespective of executeOnChange.\n            //\n            // When executeOnChange is true, run should be\n            // automatically executed on change of run and we shouldn't\n            // set shouldExecute.current to false\n\n            shouldExecute.current = false;\n        }\n\n        if (!shouldExecute.current && executeOnChange) {\n            // When executeOnLoad is false and executeOnChange is true,\n            // changes to run should trigger run automatically.\n            // As shouldExecute.current is set to false initially due to executeOnLoad\n            // being false, we change it to true.\n            shouldExecute.current = true;\n        }\n    }, [run, executeOnChange]);\n\n    useEffect(() => () => {\n        isUnhooked.current = true;\n    }, []);\n\n    return {\n        data,\n        loading,\n        error,\n        taskResult,\n        execute: run,\n    };\n};\n\nexport default useAsync;\n"],"names":["root","factory","exports","module","require","define","amd","self","__WEBPACK_EXTERNAL_MODULE__156__","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","__webpack_modules__","n","getter","__esModule","d","a","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","defaultConfig","dataLoader","x","executeOnLoad","executeOnChange","initialData","onError","error","console","configAliases","autoExecute","config","task","mergeConfig","defaults","result","entries","forEach","_ref","keyToBeAliased","alias","_ref2","value","data","setData","useState","setError","taskResult","setTaskResult","loading","setLoading","isUnhooked","useRef","shouldExecute","run","useCallback","async","unhooked","current","res","arguments","retrievedData","e","useEffect","execute"],"sourceRoot":""}